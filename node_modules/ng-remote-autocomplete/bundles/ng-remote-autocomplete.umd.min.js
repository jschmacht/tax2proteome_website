!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs/Subject"),require("@angular/forms"),require("@angular/common")):"function"==typeof define&&define.amd?define("ng-remote-autocomplete",["exports","@angular/core","rxjs/Subject","@angular/forms","@angular/common"],t):t(e["ng-remote-autocomplete"]={},e.ng.core,e.rxjs.Subject,e.ng.forms,e.ng.common)}(this,function(e,i,t,n,r){"use strict";var s="autocomplete-search-wrapper",c="autocomplete-option",o={Untracked:0,Loading:1,Finished:2};o[o.Untracked]="Untracked",o[o.Loading]="Loading",o[o.Finished]="Finished";var a=function(){function e(e){this.template=e}return e.decorators=[{type:i.Directive,args:[{selector:"[remote-autocomplete-option-tmpl]"}]}],e.ctorParameters=function(){return[{type:i.TemplateRef}]},e}(),p=function(){function e(){this.changedHighlightItemSubject=new t.Subject,this.selectItemSubject=new t.Subject,this._isOpen=!1}return Object.defineProperty(e.prototype,"isOpen",{get:function(){return this._isOpen},set:function(e){this._isOpen=e},enumerable:!0,configurable:!0}),e.decorators=[{type:i.Injectable}],e}(),u=function(){function e(e){this.autocompleteService=e,this._activeIndex=-1,this.items=[]}return Object.defineProperty(e.prototype,"activeIndex",{get:function(){return this._activeIndex},set:function(e){if(this.autocompleteService.isOpen){if(e>=this.items.length)return void this.restoreIntialActiveIndex();if(e<-1)return this._activeIndex=this.items.length-1,void this.autocompleteService.changedHighlightItemSubject.next(this._activeIndex);this._activeIndex=e,this.autocompleteService.changedHighlightItemSubject.next(this._activeIndex)}},enumerable:!0,configurable:!0}),e.prototype.restoreIntialActiveIndex=function(){this._activeIndex=-1,this.autocompleteService.changedHighlightItemSubject.next(this._activeIndex)},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:p}]},e}(),h=function(){function e(e,t){this.itemListService=e,this.autocompleteService=t,this.stopEnterPropagationOnSelect=!1,this.needToShowNotFoundText=!0,this.needToShowSearchingText=!0,this.type=new i.EventEmitter,this.highlighted=new i.EventEmitter,this.selected=new i.EventEmitter,this.blur=new i.EventEmitter,this.focusEvent=new i.EventEmitter,this.searchStates=o,this.searchState=o.Untracked,this.SEARCH_WRAPPER_CLASS=s,this.OPTION_LIST_WRAPPER_CLASS="option-list-wrapper",this.OPTION_CLASS=c,this.OPTION_VALUE_CLASS="autocomplete-option-value",this.OPTION_DESCRIPTION_CLASS="autocomplete-option-description",this.LOADING_CLASS="autocomplete-loading",this.RESULTS_NOT_FOUND_CLASS="autocomplete-not-found",this.propagateChange=function(e){},this.propagateTouched=function(e){}}return e.prototype.ngOnInit=function(){var i=this;this.validateService(),this.disabled=this.getDefaultIfNullOrUndefined(this.disabled,!1),this.minChars=this.getDefaultIfNullOrUndefined(this.minChars,1),this.maxChars=this.maxChars||2147483647,this.pause=this.pause||100,this.notFoundText=this.notFoundText||"No results found",this.searchingText=this.searchingText||"Searching...",this.changedHighlightSubscription=this.autocompleteService.changedHighlightItemSubject.subscribe(function(e){i.onActiveIndexChanged(e)}),this.selectSubscription=this.autocompleteService.selectItemSubject.subscribe(function(e){var t=i.searchResult[e];i.propagateChange(t.value),i.selected.emit(t),i.close()})},e.prototype.ngOnDestroy=function(){this.changedHighlightSubscription.unsubscribe(),this.selectSubscription.unsubscribe()},e.prototype.writeValue=function(e){e!==undefined&&(this.searchValue=e)},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(e){this.propagateTouched=e},e.prototype.setDisabledState=function(e){this.disabled=e},e.prototype.onType=function(){this.propagateChange(this.searchValue),this.originalSearchValue=this.searchValue,this.type.emit(),this.validsearchTerm()?this.searchState=this.searchStates.Loading:this.close(),this.resetSearchTimeout()},e.prototype.onInputBlur=function(e){if(e.relatedTarget&&e.relatedTarget.classList.contains(this.OPTION_CLASS))return;this.propagateTouched(this.searchValue),this.close(),this.blur.emit(e)},e.prototype.onInputFocus=function(e){this.focusEvent.emit(e)},Object.defineProperty(e.prototype,"inputClass",{get:function(){var e="";return this.inputClasses&&(e=this.inputClasses.join(" ")),e},enumerable:!0,configurable:!0}),e.prototype.focus=function(){this.inputField.nativeElement.focus()},e.prototype.open=function(){this.onType()},e.prototype.close=function(){this.autocompleteService.isOpen=!1,this.searchState=this.searchStates.Untracked},e.prototype.validateService=function(){if(!this.service)throw new Error("AutocompleteService must be implemented");if(this.isParameterizedSearch(this.service)&&(this.searchParameters===undefined||null===this.searchParameters))throw new Error("Please provide additionalSearchParams or just provide AutocompleteSourceService instaead of ParameterizedAutocompleteSourceService")},e.prototype.onActiveIndexChanged=function(e){var t;-1===e?(t=null,this.searchValue=this.originalSearchValue):(t=this.searchResult[e],this.searchValue=t.value),this.propagateChange(this.searchValue),this.highlighted.emit(t)},e.prototype.resetSearchTimeout=function(){this.clearSearchTimeout(),this.setSearchTimeout()},e.prototype.setSearchTimeout=function(){this.typingTimeout=setTimeout(this.search.bind(this),this.pause)},e.prototype.clearSearchTimeout=function(){clearTimeout(this.typingTimeout)},e.prototype.search=function(){var t=this;this.itemListService.restoreIntialActiveIndex(),this.validsearchTerm()&&this.performSearch().first().subscribe(function(e){t.searchState!==t.searchStates.Untracked&&(t.autocompleteService.isOpen=0<e.length,t.itemListService.items=e,t.searchResult=e,t.searchState=t.searchStates.Finished)})},e.prototype.performSearch=function(){return this.isParameterizedSearch(this.service)?this.service.getWithParams(this.searchValue,this.searchParameters):this.service.get(this.searchValue)},e.prototype.validsearchTerm=function(){return(this.searchValue||"").length>=this.minChars},e.prototype.isParameterizedSearch=function(e){return e.getWithParams!==undefined},e.prototype.getDefaultIfNullOrUndefined=function(e,t){return e===undefined||null===e?t:e},e.decorators=[{type:i.Component,args:[{selector:"remote-autocomplete",template:'<div keyboard-navigation [stopEnterPropagation]="stopEnterPropagationOnSelect" class="remote-autocomplete">\n    <input [(ngModel)]="searchValue"\n           [attr.id]="inputId"\n           [attr.name]="inputName"\n           [attr.class]="inputClass"\n           [disabled]="disabled"\n           [attr.placeholder]="placeholder"\n           [attr.autocomplete]="autocompleteAttr"\n           [attr.tabindex]="tabindex"\n           maxlength="{{maxChars}}"\n           (input)="onType()"\n           (blur)="onInputBlur($event)"\n           (focus)="onInputFocus($event)"\n           #input />\n    <div *ngIf="searchState === searchStates.Loading && needToShowSearchingText || \n                searchState === searchStates.Finished && (searchResult?.length > 0 || needToShowNotFoundText)" [class]="SEARCH_WRAPPER_CLASS">\n        <div *ngIf="searchState === searchStates.Loading">\n            <span [class]="LOADING_CLASS">{{searchingText}}</span>\n        </div>\n\n        <div *ngIf="searchState === searchStates.Finished && searchResult.length === 0">\n            <span [class]="RESULTS_NOT_FOUND_CLASS">{{notFoundText}}</span>\n        </div>\n\n        <div *ngIf="searchState === searchStates.Finished && searchResult?.length > 0" [class]="OPTION_LIST_WRAPPER_CLASS">\n            <div *ngFor="let item of searchResult; index as i"\n                 remote-autocomplete-option\n                 [itemIndex]="i"\n                 [class]="OPTION_CLASS"\n                 [ngClass]="{\'autocomplete-option-active\': i === itemListService.activeIndex}"\n                 tabindex="-1">\n                <ng-template #defaultOptionTemplate>\n                    <span [class]="OPTION_VALUE_CLASS">{{item.value}}</span>\n                    <span *ngIf="item.description" [class]="OPTION_DESCRIPTION_CLASS">{{item.description}}</span>\n                </ng-template>\n\n                <ng-template [ngTemplateOutlet]="optionTemplate || defaultOptionTemplate" [ngTemplateOutletContext]="{ $implicit: item }">\n                </ng-template>\n            </div>\n        </div>\n    </div>\n</div>',styles:[".autocomplete-search-wrapper{border:1px solid #ccc;max-height:200px;overflow:auto;max-width:200px}.autocomplete-option-active{background-color:#d3d3d3}"],providers:[p,u,{provide:n.NG_VALUE_ACCESSOR,useExisting:i.forwardRef(function(){return e}),multi:!0}]}]}],e.ctorParameters=function(){return[{type:u},{type:p}]},e.propDecorators={service:[{type:i.Input,args:["service"]}],minChars:[{type:i.Input,args:["minSearchLength"]}],maxChars:[{type:i.Input,args:["maxChars"]}],pause:[{type:i.Input,args:["pause"]}],inputId:[{type:i.Input,args:["inputId"]}],inputName:[{type:i.Input,args:["inputName"]}],inputClasses:[{type:i.Input,args:["inputClass"]}],disabled:[{type:i.Input,args:["disabled"]}],notFoundText:[{type:i.Input,args:["notFoundText"]}],searchingText:[{type:i.Input,args:["searchingText"]}],placeholder:[{type:i.Input,args:["placeholder"]}],searchParameters:[{type:i.Input,args:["searchParameters"]}],autocompleteAttr:[{type:i.Input,args:["autocompleteAttr"]}],tabindex:[{type:i.Input,args:["tabindex"]}],stopEnterPropagationOnSelect:[{type:i.Input,args:["stopEnterPropagationOnSelect"]}],needToShowNotFoundText:[{type:i.Input,args:["needToShowNotFoundText"]}],needToShowSearchingText:[{type:i.Input,args:["needToShowSearchingText"]}],type:[{type:i.Output,args:["type"]}],highlighted:[{type:i.Output,args:["highlighted"]}],selected:[{type:i.Output,args:["selected"]}],blur:[{type:i.Output,args:["blur"]}],focusEvent:[{type:i.Output,args:["focus"]}],optionTemplate:[{type:i.ContentChild,args:[a,{read:i.TemplateRef}]}],inputField:[{type:i.ViewChild,args:["input"]}]},e}(),l=function(){function e(e,t){this.autocompleteService=e,this.itemListService=t}return e.prototype.onMouseEnter=function(e){this.itemListService.activeIndex=this.index},e.prototype.onMouseLeave=function(e){this.itemListService.restoreIntialActiveIndex()},e.prototype.onClick=function(e){this.autocompleteService.selectItemSubject.next(this.index)},e.decorators=[{type:i.Directive,args:[{selector:"[remote-autocomplete-option]",host:{"(mouseenter)":"onMouseEnter($event)","(mouseleave)":"onMouseLeave($event)","(click)":"onClick($event)"}}]}],e.ctorParameters=function(){return[{type:p},{type:u}]},e.propDecorators={index:[{type:i.Input,args:["itemIndex"]}]},e}(),d={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,PauseBreak:19,CapsLock:20,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46,Zero:48,ClosedParen:48,One:49,ExclamationMark:49,Two:50,AtSign:50,Three:51,PoundSign:51,Hash:51,Four:52,DollarSign:52,Five:53,PercentSign:53,Six:54,Caret:54,Hat:54,Seven:55,Ampersand:55,Eight:56,Star:56,Asterik:56,Nine:57,OpenParen:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftWindowKey:91,RightWindowKey:92,SelectKey:93,Numpad0:96,Numpad1:97,Numpad2:98,Numpad3:99,Numpad4:100,Numpad5:101,Numpad6:102,Numpad7:103,Numpad8:104,Numpad9:105,Multiply:106,Add:107,Subtract:109,DecimalPoint:110,Divide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NumLock:144,ScrollLock:145,SemiColon:186,Equals:187,Comma:188,Dash:189,Period:190,UnderScore:189,PlusSign:187,ForwardSlash:191,Tilde:192,GraveAccent:192,OpenBracket:219,ClosedBracket:221,Quote:222};d[d.Backspace]="Backspace",d[d.Tab]="Tab",d[d.Enter]="Enter",d[d.Shift]="Shift",d[d.Ctrl]="Ctrl",d[d.Alt]="Alt",d[d.PauseBreak]="PauseBreak",d[d.CapsLock]="CapsLock",d[d.Escape]="Escape",d[d.Space]="Space",d[d.PageUp]="PageUp",d[d.PageDown]="PageDown",d[d.End]="End",d[d.Home]="Home",d[d.LeftArrow]="LeftArrow",d[d.UpArrow]="UpArrow",d[d.RightArrow]="RightArrow",d[d.DownArrow]="DownArrow",d[d.Insert]="Insert",d[d.Delete]="Delete",d[d.Zero]="Zero",d[d.ClosedParen]="ClosedParen",d[d.One]="One",d[d.ExclamationMark]="ExclamationMark",d[d.Two]="Two",d[d.AtSign]="AtSign",d[d.Three]="Three",d[d.PoundSign]="PoundSign",d[d.Hash]="Hash",d[d.Four]="Four",d[d.DollarSign]="DollarSign",d[d.Five]="Five",d[d.PercentSign]="PercentSign",d[d.Six]="Six",d[d.Caret]="Caret",d[d.Hat]="Hat",d[d.Seven]="Seven",d[d.Ampersand]="Ampersand",d[d.Eight]="Eight",d[d.Star]="Star",d[d.Asterik]="Asterik",d[d.Nine]="Nine",d[d.OpenParen]="OpenParen",d[d.A]="A",d[d.B]="B",d[d.C]="C",d[d.D]="D",d[d.E]="E",d[d.F]="F",d[d.G]="G",d[d.H]="H",d[d.I]="I",d[d.J]="J",d[d.K]="K",d[d.L]="L",d[d.M]="M",d[d.N]="N",d[d.O]="O",d[d.P]="P",d[d.Q]="Q",d[d.R]="R",d[d.S]="S",d[d.T]="T",d[d.U]="U",d[d.V]="V",d[d.W]="W",d[d.X]="X",d[d.Y]="Y",d[d.Z]="Z",d[d.LeftWindowKey]="LeftWindowKey",d[d.RightWindowKey]="RightWindowKey",d[d.SelectKey]="SelectKey",d[d.Numpad0]="Numpad0",d[d.Numpad1]="Numpad1",d[d.Numpad2]="Numpad2",d[d.Numpad3]="Numpad3",d[d.Numpad4]="Numpad4",d[d.Numpad5]="Numpad5",d[d.Numpad6]="Numpad6",d[d.Numpad7]="Numpad7",d[d.Numpad8]="Numpad8",d[d.Numpad9]="Numpad9",d[d.Multiply]="Multiply",d[d.Add]="Add",d[d.Subtract]="Subtract",d[d.DecimalPoint]="DecimalPoint",d[d.Divide]="Divide",d[d.F1]="F1",d[d.F2]="F2",d[d.F3]="F3",d[d.F4]="F4",d[d.F5]="F5",d[d.F6]="F6",d[d.F7]="F7",d[d.F8]="F8",d[d.F9]="F9",d[d.F10]="F10",d[d.F11]="F11",d[d.F12]="F12",d[d.NumLock]="NumLock",d[d.ScrollLock]="ScrollLock",d[d.SemiColon]="SemiColon",d[d.Equals]="Equals",d[d.Comma]="Comma",d[d.Dash]="Dash",d[d.Period]="Period",d[d.UnderScore]="UnderScore",d[d.PlusSign]="PlusSign",d[d.ForwardSlash]="ForwardSlash",d[d.Tilde]="Tilde",d[d.GraveAccent]="GraveAccent",d[d.OpenBracket]="OpenBracket",d[d.ClosedBracket]="ClosedBracket",d[d.Quote]="Quote";var m=function(){function e(e){this.element=e}return e.prototype.handleKeyboarOptionNavigation=function(e){var t=this.element.nativeElement.querySelector("."+s);if(t){if(-1===e)return void t.scrollTo(0,0);var i=t.querySelectorAll("."+c)[e],n=t.getBoundingClientRect().top,r=n+t.clientHeight,o=i.getBoundingClientRect().top,a=o+i.clientHeight;o<n&&i.scrollIntoView(!0),r<a&&i.scrollIntoView(!1)}},e}(),S=function(){function e(e,t,i){this.autocompleteService=e,this.itemListService=t,this.element=i,this.stopEnterPropagation=!1,this.scrollService=new m(i)}return e.prototype.onKeydown=function(e){switch(e.which||e.keyCode){case d.DownArrow:this.handleDownKey(e);break;case d.UpArrow:this.handleUpKey(e);break;case d.Enter:this.handleEnter(e)}},e.prototype.handleDownKey=function(e){this.itemListService.activeIndex++,this.scrollService.handleKeyboarOptionNavigation(this.itemListService.activeIndex)},e.prototype.handleUpKey=function(e){this.itemListService.activeIndex--,this.scrollService.handleKeyboarOptionNavigation(this.itemListService.activeIndex)},e.prototype.handleEnter=function(e){0<=this.itemListService.activeIndex&&(this.autocompleteService.selectItemSubject.next(this.itemListService.activeIndex),e.preventDefault(),this.stopEnterPropagation&&e.stopPropagation())},e.decorators=[{type:i.Directive,args:[{selector:"[keyboard-navigation]"}]}],e.ctorParameters=function(){return[{type:p},{type:u},{type:i.ElementRef}]},e.propDecorators={stopEnterPropagation:[{type:i.Input}],onKeydown:[{type:i.HostListener,args:["keydown",["$event"]]}]},e}(),g=function(){function e(){}return e.decorators=[{type:i.NgModule,args:[{imports:[r.CommonModule,n.FormsModule],declarations:[h,a,l,S],exports:[h,a]}]}],e}();e.RemoteAutocompleteModule=g,e.RemoteAutocompleteComponent=h,e.OptionTemplateDirective=a,e.ɵd=S,e.ɵc=l,e.ɵa=p,e.ɵb=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ng-remote-autocomplete.umd.min.js.map